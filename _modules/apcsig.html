

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>apcsig &mdash; documentación de Documentación de funciones y algoritmos en Python y Qgis para análisis espacial - 1.0</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Documentación de funciones y algoritmos en Python y Qgis para análisis espacial
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Guias de uso:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ejecucion.html">¿Cómo ejecutar un código en Qgis?</a></li>
</ul>
<p class="caption"><span class="caption-text">Códigos:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apcsig.html">Libreria de funciones para el análisis espacial multicriterio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../verificacion.html">Verificación de capas</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Documentación de funciones y algoritmos en Python y Qgis para análisis espacial</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Código de módulo</a> &raquo;</li>
        
      <li>apcsig</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Código fuente para apcsig</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Autor: Víctor Hernández D.</span>

<span class="sd">Correo: victor.hernandez@iecologia.unam.mx</span>

<span class="sd">user_github: @vichdzgeo</span>

<span class="sd">Colaboladores: LANCIS - UNAM</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">qgis</span> 
<span class="kn">import</span> <span class="nn">qgis.core</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span class="n">gdal</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">processing</span> <span class="k">as</span> <span class="nn">pr</span> 
<span class="kn">import</span> <span class="nn">gdalnumeric</span>
<span class="kn">import</span> <span class="nn">gdal_calc</span>



<div class="viewcode-block" id="corrige_geometria"><a class="viewcode-back" href="../apcsig.html#apcsig.corrige_geometria">[documentos]</a><span class="k">def</span> <span class="nf">corrige_geometria</span><span class="p">(</span><span class="n">path_v</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función corrige la geometría de una capa vectorial</span>
<span class="sd">    por medio de la función nativa de qgis &quot;fixgeometries&quot;, gerarando </span>
<span class="sd">    como resultado en la misma ruta, una capa con el mismo nombre pero con </span>
<span class="sd">    terminación &quot;_fix.shp&quot; </span>

<span class="sd">    Este procedimiento se implementa ya que se ha detectado que varios geoprocesos</span>
<span class="sd">    vectoriales no funcionan de una manera óptima si las geometrías están corruptas.</span>
<span class="sd">   </span>
<span class="sd">    :param path_v: ruta del archivo shape</span>
<span class="sd">    :type path_v: str</span>

<span class="sd">    :returns: Ruta del archivo shape con la geometría corregida</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dicc</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">path_v</span><span class="p">,</span>
    <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_fix.&quot;</span><span class="o">+</span><span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;native:fixgeometries&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_fix.&quot;</span><span class="o">+</span><span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span></div>
<span class="k">def</span> <span class="nf">union</span> <span class="p">(</span><span class="n">capa</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span><span class="n">salida</span><span class="p">):</span>
    <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">capa</span><span class="p">,</span>
                                    <span class="s1">&#39;OVERLAY&#39;</span><span class="p">:</span><span class="n">overlay</span><span class="p">,</span>
                                    <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;native:union&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">diferencia</span><span class="p">(</span><span class="n">capa</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span><span class="n">salida</span><span class="p">):</span>
    <span class="n">dicc</span> <span class="o">=</span>     <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">capa</span><span class="p">,</span>
                                    <span class="s1">&#39;OVERLAY&#39;</span><span class="p">:</span><span class="n">overlay</span><span class="p">,</span>
                                    <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;native:difference&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span>
<div class="viewcode-block" id="single_poligonos"><a class="viewcode-back" href="../apcsig.html#apcsig.single_poligonos">[documentos]</a><span class="k">def</span> <span class="nf">single_poligonos</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="n">salida</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Función que transforma una capa multipolígono a polígonos individuales.</span>

<span class="sd">    :param path_v: ruta de la capa vectorial multipoligono</span>
<span class="sd">    :type path_v: str</span>

<span class="sd">    :param salida: ruta de la capa vectorial de polígonos individuales</span>
<span class="sd">    :type salida: str</span>

<span class="sd">    .. note:: </span>
<span class="sd">        Utilizar previamente la función corrige_geometria para la capa de entrada a ésta función.</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">path_v</span><span class="p">,</span>
                    <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;native:multiparttosingleparts&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<span class="k">def</span> <span class="nf">interseccion</span><span class="p">(</span><span class="n">capa_a</span><span class="p">,</span><span class="n">capa_b</span><span class="p">,</span><span class="n">salida</span><span class="p">):</span>
    <span class="n">dicc</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">capa_a</span><span class="p">,</span>
                    <span class="s1">&#39;OVERLAY&#39;</span><span class="p">:</span><span class="n">capa_b</span><span class="p">,</span>
                    <span class="s1">&#39;INPUT_FIELDS&#39;</span><span class="p">:[],</span>
                    <span class="s1">&#39;OVERLAY_FIELDS&#39;</span><span class="p">:[],</span>
                    <span class="s1">&#39;OVERLAY_FIELDS_PREFIX&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;native:intersection&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span>
<span class="c1">######## FUNCIONES GENERALES ###########</span>
<span class="k">def</span> <span class="nf">nombre_capa</span><span class="p">(</span><span class="n">path_capa</span><span class="p">):</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">path_capa</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">nombre</span>
<div class="viewcode-block" id="lista_archivos"><a class="viewcode-back" href="../apcsig.html#apcsig.lista_archivos">[documentos]</a><span class="k">def</span> <span class="nf">lista_archivos</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">n_ext</span><span class="o">=</span><span class="s1">&#39;.tif&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Ésta función busca dentro de un directorio todos los archivos con el tipo de extensión</span>
<span class="sd">    declarada.</span>

<span class="sd">    :param path: ruta del direcctorio que contiene los archivos</span>
<span class="sd">    :type path: str</span>

<span class="sd">    :returns: lista con la ruta de cada archivo localizado en el directorio y subdirectorios</span>
<span class="sd">    :rtype: list </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">lista_shp</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">extension</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">n_ext</span><span class="p">:</span>
                <span class="n">ruta</span> <span class="o">=</span> <span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">name</span>
                <span class="n">lista_shp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ruta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lista_shp</span></div>
<div class="viewcode-block" id="reproyectar_a_utm"><a class="viewcode-back" href="../apcsig.html#apcsig.reproyectar_a_utm">[documentos]</a><span class="k">def</span> <span class="nf">reproyectar_a_utm</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="n">path_v_reproyectado</span><span class="p">,</span><span class="n">zona_norte</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Función que reproyecta una capa shapefile a UTM/WGS84 para las zonas válidas de México.</span>

<span class="sd">    :path_v: Ruta de la capa shapefile original.</span>
<span class="sd">    :typy path_v: str</span>

<span class="sd">    :path_v_reproyectado: Ruta y nombre de la capa shapefile que se exporatá con proyección UTM/WGS84.</span>
<span class="sd">    :type path_v_reproyectado:str </span>

<span class="sd">    :zona_norte: Número de zona UTM a la que se desea exportar la capa Shapefile (11 hasta la 16).</span>
<span class="sd">    :type zona_norte: int</span>


<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zona_norte</span><span class="o">==</span><span class="mi">11</span><span class="p">:</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">QgsCoordinateReferenceSystem</span><span class="p">(</span><span class="s2">&quot;EPSG:32611&quot;</span><span class="p">)</span>
        <span class="n">proyecta</span> <span class="o">=</span> <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">vlayer</span><span class="p">,</span><span class="n">path_v_reproyectado</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span><span class="n">crs</span><span class="p">,</span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">zona_norte</span><span class="o">==</span><span class="mi">12</span><span class="p">:</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">QgsCoordinateReferenceSystem</span><span class="p">(</span><span class="s2">&quot;EPSG:32612&quot;</span><span class="p">)</span>
        <span class="n">proyecta</span> <span class="o">=</span> <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">vlayer</span><span class="p">,</span><span class="n">path_v_reproyectado</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span><span class="n">crs</span><span class="p">,</span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">zona_norte</span><span class="o">==</span><span class="mi">13</span><span class="p">:</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">QgsCoordinateReferenceSystem</span><span class="p">(</span><span class="s2">&quot;EPSG:32613&quot;</span><span class="p">)</span>
        <span class="n">proyecta</span> <span class="o">=</span> <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">vlayer</span><span class="p">,</span><span class="n">path_v_reproyectado</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span><span class="n">crs</span><span class="p">,</span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">zona_norte</span><span class="o">==</span><span class="mi">14</span><span class="p">:</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">QgsCoordinateReferenceSystem</span><span class="p">(</span><span class="s2">&quot;EPSG:32614&quot;</span><span class="p">)</span>
        <span class="n">proyecta</span> <span class="o">=</span> <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">vlayer</span><span class="p">,</span><span class="n">path_v_reproyectado</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span><span class="n">crs</span><span class="p">,</span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">zona_norte</span><span class="o">==</span><span class="mi">15</span><span class="p">:</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">QgsCoordinateReferenceSystem</span><span class="p">(</span><span class="s2">&quot;EPSG:32615&quot;</span><span class="p">)</span>
        <span class="n">proyecta</span> <span class="o">=</span> <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">vlayer</span><span class="p">,</span><span class="n">path_v_reproyectado</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span><span class="n">crs</span><span class="p">,</span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">zona_norte</span><span class="o">==</span><span class="mi">16</span><span class="p">:</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">QgsCoordinateReferenceSystem</span><span class="p">(</span><span class="s2">&quot;EPSG:32616&quot;</span><span class="p">)</span>
        <span class="n">proyecta</span> <span class="o">=</span> <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">vlayer</span><span class="p">,</span><span class="n">path_v_reproyectado</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span><span class="n">crs</span><span class="p">,</span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;error en el numero de zona&quot;</span><span class="p">)</span></div>
<span class="c1">### FUNCIONES PARA CLASIFICAR  ########</span>

<div class="viewcode-block" id="progressive"><a class="viewcode-back" href="../apcsig.html#apcsig.progressive">[documentos]</a><span class="k">def</span> <span class="nf">progressive</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Función que reclasifica un rango de valores de 0 a 1 en n categorias </span>
<span class="sd">    por el clasificador Progresiva.</span>

<span class="sd">    :param fp: Factor de progresión.</span>
<span class="sd">    :type fp: int</span>

<span class="sd">    :param min: Valor mínimo del rango a clasificar.</span>
<span class="sd">    :type min: float</span>

<span class="sd">    :param max: Valor máximo del rango a clasificar.</span>
<span class="sd">    :type max: float</span>

<span class="sd">    :param categories: número de categorias</span>
<span class="sd">    :type categories: int</span>

<span class="sd">    :returns: lista con los intervalos de corte </span>
<span class="sd">    :rtype: list </span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># # Cortes de categories siguiendo Ley de Weber</span>
    <span class="c1"># print &#39;\n\t\t////Cortes de categories siguiendo Ley de Weber-Feshner////\n&#39;</span>
    
    <span class="n">numeroDeCortes</span> <span class="o">=</span> <span class="n">categories</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">laSuma</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">laSuma</span> <span class="o">+=</span> <span class="p">((</span><span class="n">fp</span><span class="p">)</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">cachito</span> <span class="o">=</span> <span class="nb">max</span> <span class="o">/</span> <span class="n">laSuma</span>

    <span class="n">FuzzyCut</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numeroDeCortes</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">anterior</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">anterior</span> <span class="o">=</span> <span class="n">FuzzyCut</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">corte</span> <span class="o">=</span> <span class="n">anterior</span> <span class="o">+</span> <span class="n">fp</span> <span class="o">**</span> <span class="n">i</span> <span class="o">*</span> <span class="n">cachito</span>
        <span class="n">FuzzyCut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corte</span><span class="p">)</span>

    <span class="n">FuzzyCut</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">min</span><span class="p">)</span>
    <span class="n">FuzzyCut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">FuzzyCut</span></div>
<div class="viewcode-block" id="wf"><a class="viewcode-back" href="../apcsig.html#apcsig.wf">[documentos]</a><span class="k">def</span> <span class="nf">wf</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">categories</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Función que reclasifica un rango de valores de 0 a 1 en  n categorias </span>
<span class="sd">    por Weber-Fechner.</span>

<span class="sd">    :param fp: Factor de progresión.</span>
<span class="sd">    :type fp: int</span>

<span class="sd">    :param min: Valor mínimo del rango a clasificar.</span>
<span class="sd">    :type min: float</span>

<span class="sd">    :param max: Valor máximo del rango a clasificar.</span>
<span class="sd">    :type max: float</span>

<span class="sd">    :param categories: número de categorias</span>
<span class="sd">    :type categories: int</span>

<span class="sd">    :returns: lista con los intervalos de corte </span>
<span class="sd">    :rtype: list </span>
<span class="sd">    &#39;&#39;&#39;</span>     
    
    <span class="n">dicc_e</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">lista_val</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">,]</span>
    <span class="n">pm</span> <span class="o">=</span> <span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span> 
    <span class="n">cats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">categories</span><span class="p">)</span>
    <span class="n">e0</span> <span class="o">=</span> <span class="n">pm</span><span class="o">/</span><span class="n">cats</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="p">,</span> <span class="n">categories</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">dicc_e</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">=</span> <span class="nb">min</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">e0</span><span class="p">)</span>
        
    <span class="nb">print</span> <span class="p">(</span><span class="n">dicc_e</span><span class="p">)</span>
    <span class="n">dicc_cortes</span> <span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="p">,</span> <span class="n">categories</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">lista_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">dicc_e</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">lista_val</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lista_val</span></div>
<div class="viewcode-block" id="cuantiles_s"><a class="viewcode-back" href="../apcsig.html#apcsig.cuantiles_s">[documentos]</a><span class="k">def</span> <span class="nf">cuantiles_s</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="n">quantil</span><span class="p">,</span><span class="n">field</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función regresa la lista de cortes según el cuantil </span>
<span class="sd">    deseado de los valores de un campo de la capa vectorial de entrada</span>

<span class="sd">    :param path_v: ruta de la capa vectorial</span>
<span class="sd">    :type path_v: str</span>
<span class="sd">        </span>
<span class="sd">    :param quantil: cuantil  </span>
<span class="sd">    :type quantil: int </span>

<span class="sd">    :param field: nombre del campo</span>
<span class="sd">    :type field: str</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">no_geometry</span> <span class="o">=</span>  <span class="n">QgsFeatureRequest</span><span class="p">()</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QgsFeatureRequest</span><span class="o">.</span><span class="n">NoGeometry</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">(</span><span class="n">no_geometry</span><span class="p">)]</span>
    <span class="n">array_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="nb">min</span><span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">lista_val</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">,]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">quantil</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">value</span><span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="n">quantil</span>
        <span class="n">cuantil_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">array_val</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
        <span class="n">lista_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cuantil_c</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lista_val</span></div>
<div class="viewcode-block" id="equidistantes"><a class="viewcode-back" href="../apcsig.html#apcsig.equidistantes">[documentos]</a><span class="k">def</span> <span class="nf">equidistantes</span> <span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función regresa la lista de cortes equidistantes según el número </span>
<span class="sd">    de categorias y el valor minimo y maximo ingresados.</span>

<span class="sd">    :param categories: número de categorias </span>
<span class="sd">    :type categories: int </span>

<span class="sd">    :param min: valor mínimo de la capa</span>
<span class="sd">    :type min: float</span>

<span class="sd">    :param max: valor máximo de la capa</span>
<span class="sd">    :type max: float</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">lista_val</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">,]</span>
    <span class="n">incremento</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="n">categories</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">categories</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">valor</span> <span class="o">=</span> <span class="nb">min</span> <span class="o">+</span> <span class="p">(</span><span class="n">incremento</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">lista_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lista_val</span></div>
<div class="viewcode-block" id="max_min_vector"><a class="viewcode-back" href="../apcsig.html#apcsig.max_min_vector">[documentos]</a><span class="k">def</span> <span class="nf">max_min_vector</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">campo</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función regresa el maximo y minimo del campo</span>
<span class="sd">    elegido de la capa vectorial de entrada</span>

<span class="sd">    :param layer: capa vectorial</span>
<span class="sd">    :type layer: QgsLayer</span>

<span class="sd">    :param campo: nombre del campo</span>
<span class="sd">    :type campo: str </span>


<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">idx</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">fields</span><span class="p">()</span><span class="o">.</span><span class="n">indexFromName</span><span class="p">(</span><span class="n">campo</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">minimumValue</span><span class="p">(</span><span class="n">idx</span><span class="p">),</span><span class="mi">3</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">maximumValue</span><span class="p">(</span><span class="n">idx</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span></div>

<span class="c1">######## FUNCIONES A DATOS VECTORIALES ###########</span>

<div class="viewcode-block" id="crear_campo"><a class="viewcode-back" href="../apcsig.html#apcsig.crear_campo">[documentos]</a><span class="k">def</span> <span class="nf">crear_campo</span><span class="p">(</span> <span class="n">path_vector</span><span class="p">,</span> <span class="n">nombre_campo</span><span class="p">,</span> <span class="n">tipo</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Esta funcion crea un campo segun el tipo especificado.</span>
<span class="sd">    Parametros:</span>
<span class="sd">    :param path_vector: La ruta del archivo shapefile al cual se le quiere \</span>
<span class="sd">                        agregar el campo</span>
<span class="sd">    :type path_vector: String</span>

<span class="sd">    :param nombre_campo: Nombre del campo nuevo</span>
<span class="sd">    :type nombre_campo: Sting</span>

<span class="sd">    :param tipo: es el tipo de campo que se quiere crear</span>

<span class="sd">    Int: para crear un campo tipo entero</span>
<span class="sd">    Double: para crear un campo tipo doble o flotante</span>
<span class="sd">    String: para crear un campo tipo texto</span>
<span class="sd">    Date: para crear un campo tipo fecha</span>
<span class="sd">    :type tipo: String</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">campos</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">nombre_campo</span> <span class="ow">in</span> <span class="n">campos</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;el campo ya existe&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nombre_campo</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;el nombre del campo debe contener maximo 10 caracteres&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;Int&quot;</span><span class="p">:</span>
                <span class="n">nombre</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="n">nombre_campo</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                                                            <span class="n">QVariant</span><span class="o">.</span><span class="n">Int</span><span class="p">)])</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;Double&quot;</span><span class="p">:</span>
                <span class="n">nombre</span><span class="o">=</span><span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="n">nombre_campo</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                                                            <span class="n">QVariant</span><span class="o">.</span><span class="n">Double</span><span class="p">)])</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;String&quot;</span><span class="p">:</span>
                <span class="n">nombre</span><span class="o">=</span><span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="n">nombre_campo</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                                                            <span class="n">QVariant</span><span class="o">.</span><span class="n">String</span><span class="p">)])</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;Date&quot;</span><span class="p">:</span>
                <span class="n">nombre</span><span class="o">=</span><span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="n">nombre_campo</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                                                            <span class="n">QVariant</span><span class="o">.</span><span class="n">Date</span><span class="p">)])</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
                <span class="n">nombre</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;el tipo no existe o hay error en su declaracion&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="categorias_campo_csv"><a class="viewcode-back" href="../apcsig.html#apcsig.categorias_campo_csv">[documentos]</a><span class="k">def</span> <span class="nf">categorias_campo_csv</span><span class="p">(</span><span class="n">path_shape</span><span class="p">,</span><span class="n">campo</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función extrae las categorias únicas de un campo dado de una capa vectorial, el </span>
<span class="sd">    archivo csv se guarda en la misma ruta de la capa vectorial y es nombrado como : **categorias_campo_nombre_capa.csv**</span>

<span class="sd">    .. note:: </span>

<span class="sd">        En dado caso que el nombre de la categoria contenga el símbolo de &#39;,&#39; está función la remplaza por &#39;;&#39; para evitar errores en la escritura del archivo csv</span>
<span class="sd">    </span>
<span class="sd">    :param path_shape: ruta de la capa vectorial </span>
<span class="sd">    :type path_shape: str</span>

<span class="sd">    :param campo: nombre del campo que contiene las categorias</span>
<span class="sd">    :type campo: str</span>


<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">layer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_shape</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">nombre_capa</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">source</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">path_categorias</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">source</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/categorias_&quot;</span><span class="o">+</span><span class="n">campo</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">nombre_capa</span><span class="o">+</span><span class="s2">&quot;.csv&quot;</span>
    <span class="n">archivo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_categorias</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">consulta</span> <span class="o">=</span> <span class="n">QgsFeatureRequest</span><span class="p">()</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QgsFeatureRequest</span><span class="o">.</span><span class="n">NoGeometry</span><span class="p">)</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">campo</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">(</span><span class="n">consulta</span><span class="p">)]))</span>
    <span class="n">lista</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">lista</span><span class="p">)</span>
    <span class="n">archivo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;id,categoria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">)):</span>
        <span class="n">archivo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">+</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">archivo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;archivo csv de categorias creado...&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;ruta: &#39;</span><span class="p">,</span><span class="n">path_categorias</span><span class="p">)</span></div>
<div class="viewcode-block" id="campos_minusculas"><a class="viewcode-back" href="../apcsig.html#apcsig.campos_minusculas">[documentos]</a><span class="k">def</span> <span class="nf">campos_minusculas</span><span class="p">(</span><span class="n">path_shape</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función renombra los campos en minúsculas</span>

<span class="sd">    :param path_shape: Ruta de la capa vectorial</span>
<span class="sd">    :type path_shape: str</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_shape</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">campos</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
    <span class="k">for</span> <span class="n">campo</span> <span class="ow">in</span> <span class="n">campos</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">pendingFields</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">campo</span> <span class="o">==</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
                <span class="k">with</span> <span class="n">edit</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">fieldNameIndex</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
                    <span class="n">layer</span><span class="o">.</span><span class="n">renameAttribute</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Proceso terminado&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="campos_mayusculas"><a class="viewcode-back" href="../apcsig.html#apcsig.campos_mayusculas">[documentos]</a><span class="k">def</span> <span class="nf">campos_mayusculas</span><span class="p">(</span><span class="n">path_shape</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función renombra los campos en mayusculas</span>

<span class="sd">    :param path_shape: Ruta de la capa vectorial</span>
<span class="sd">    :type path_shape: str</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_shape</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">campos</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
    <span class="k">for</span> <span class="n">campo</span> <span class="ow">in</span> <span class="n">campos</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">pendingFields</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">campo</span> <span class="o">==</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
                <span class="k">with</span> <span class="n">edit</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">fieldNameIndex</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
                    <span class="n">layer</span><span class="o">.</span><span class="n">renameAttribute</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Proceso terminado&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="vcopia"><a class="viewcode-back" href="../apcsig.html#apcsig.vcopia">[documentos]</a><span class="k">def</span> <span class="nf">vcopia</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span> <span class="n">path_salida</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Crea una copia de la capa a partir de la ruta de la capa, </span>
<span class="sd">    la capa es creada con el mismo sistema de referencia que el origen y codificada en UTF-8.</span>

<span class="sd">    :param path_vector: ruta de la capa original</span>
<span class="sd">    :type path_vector: String</span>

<span class="sd">    :param path_salida: ruta de donde sera almacenada la capa</span>
<span class="sd">    :type path_salida: String</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">vlayer</span><span class="p">,</span> <span class="n">path_salida</span><span class="p">,</span>
                                                      <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span>
                                                      <span class="n">vlayer</span><span class="o">.</span><span class="n">crs</span><span class="p">(),</span>
                                                      <span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path_salida</span></div>
<div class="viewcode-block" id="llenar_campos_nulos"><a class="viewcode-back" href="../apcsig.html#apcsig.llenar_campos_nulos">[documentos]</a><span class="k">def</span> <span class="nf">llenar_campos_nulos</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span><span class="n">valor</span><span class="o">=-</span><span class="mi">9999</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    :param path_vector: Ruta de la capa vectorial</span>
<span class="sd">    :type path_vector: str</span>

<span class="sd">    :param valor: valor numérico para rellenar los campos vacios por default se establece -9999</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">layer</span><span class="o">=</span><span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>  <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">fields</span><span class="p">()</span> <span class="k">if</span>  <span class="n">field</span><span class="o">.</span><span class="n">typeName</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;String&#39;</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">typeName</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;Date&#39;</span><span class="p">]</span>
    <span class="n">layer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">poligono</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">campo</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">poligono</span><span class="p">[</span><span class="n">campo</span><span class="p">]:</span>
               <span class="n">poligono</span><span class="p">[</span><span class="n">campo</span><span class="p">]</span> <span class="o">=</span> <span class="n">valor</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">poligono</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span></div>
<div class="viewcode-block" id="capa_binaria"><a class="viewcode-back" href="../apcsig.html#apcsig.capa_binaria">[documentos]</a><span class="k">def</span> <span class="nf">capa_binaria</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="n">campo_cat</span><span class="o">=</span><span class="s1">&#39;presencia&#39;</span><span class="p">,</span> <span class="n">valor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función crea un campo llamado presencia y asigna </span>
<span class="sd">    a cada elemento el valor de 1 </span>
<span class="sd">    </span>
<span class="sd">    :param path_v: ruta de la capa vectorial</span>
<span class="sd">    :type path_v: str</span>


<span class="sd">    :param campo_cat: nombre del campo a crear, por default es presencia</span>
<span class="sd">    :type campo_cat: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">campos</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">campo_cat</span> <span class="ow">in</span> <span class="n">campos</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;el campo ya existe, se actualiza el contenido&#39;</span><span class="p">)</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
            <span class="n">l</span><span class="p">[</span><span class="n">campo_cat</span><span class="p">]</span><span class="o">=</span><span class="n">valor</span>
            <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="n">campo_cat</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span><span class="n">QVariant</span><span class="o">.</span><span class="n">Int</span><span class="p">)])</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
            <span class="n">l</span><span class="p">[</span><span class="n">campo_cat</span><span class="p">]</span><span class="o">=</span><span class="n">valor</span>
            <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;capa clasificada...&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="agregar_categorias"><a class="viewcode-back" href="../apcsig.html#apcsig.agregar_categorias">[documentos]</a><span class="k">def</span> <span class="nf">agregar_categorias</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="n">campo</span><span class="p">,</span><span class="n">nuevo_int_cats</span><span class="o">=</span><span class="s1">&#39;categorias&#39;</span><span class="p">,</span><span class="n">cont</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función reclasifica una capa en enteros consecutivos en función de las categorias únicas de un </span>
<span class="sd">    campo en especifico, como subproducto genera un archivo csv con las categorias.</span>

<span class="sd">    :param path_v: ruta de capa vectorial</span>
<span class="sd">    :type path_v: str</span>

<span class="sd">    :param campo: nombre del campo que contiene las categorias</span>
<span class="sd">    :type campo: str</span>

<span class="sd">    :param nuevo_int_cats: nombre del campo a crear, el cúal contendrá las categorias en enteros</span>
<span class="sd">    :type nuevo_int_cats: str</span>
<span class="sd">    </span>
<span class="sd">    :param cont: contador para empezar la numeración en el número indicado, por defecto es 1</span>
<span class="sd">    :type cont: int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">campos</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="n">campo</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">()]))</span>
    <span class="n">lista</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span> <span class="c1"># Ordena las categorias alfabeticamente </span>
    <span class="n">n_cats</span> <span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nuevo_int_cats</span> <span class="ow">in</span> <span class="n">campos</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;el campo ya existe, se actualiza el contenido&#39;</span><span class="p">)</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">campo</span><span class="p">]:</span>
                    <span class="n">l</span><span class="p">[</span><span class="n">nuevo_int_cats</span><span class="p">]</span><span class="o">=</span><span class="n">cont</span>
                    <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">cont</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="n">nuevo_int_cats</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span><span class="n">QVariant</span><span class="o">.</span><span class="n">Int</span><span class="p">)])</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">campo</span><span class="p">]:</span>
                    <span class="n">l</span><span class="p">[</span><span class="n">nuevo_int_cats</span><span class="p">]</span><span class="o">=</span><span class="n">cont</span>
                    <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">cont</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;capa clasificada...&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;generando archivo txt de categorias...&#39;</span><span class="p">)</span>
    <span class="n">path_tp_reglas</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/reglas_&quot;</span><span class="o">+</span><span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.txt&quot;</span>
    <span class="n">reglas</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_tp_reglas</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cont</span><span class="p">):</span>
        <span class="n">reglas</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">reglas</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">path_tp_reglas</span><span class="p">,</span><span class="n">n_cats</span></div>
<div class="viewcode-block" id="extrae_categorias"><a class="viewcode-back" href="../apcsig.html#apcsig.extrae_categorias">[documentos]</a><span class="k">def</span> <span class="nf">extrae_categorias</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="n">salida</span><span class="p">,</span><span class="n">campo</span><span class="p">,</span><span class="n">categorias</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Función que extrae elementos de un shapefile dada una lista de categorias.</span>

<span class="sd">    :param path_v: ruta de la capa vectorial</span>
<span class="sd">    :type path_v: str</span>

<span class="sd">    :param salida: ruta de la capa vectorial con elementos de las categorias de interés.</span>
<span class="sd">    :type salida: str</span>

<span class="sd">    :param campo: nombre del campo que contiene las categorias</span>
<span class="sd">    :type campo: str</span>

<span class="sd">    :param categorias: lista de categorias</span>
<span class="sd">    :type categorias: list</span>



<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorias</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">campo</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">categorias</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">querys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categorias</span><span class="p">:</span>        
            <span class="n">querys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">campo</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cat</span><span class="p">))</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">querys</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="n">selectByExpression</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">QgsVectorFileWriter</span><span class="o">.</span><span class="n">writeAsVectorFormat</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">salida</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">layer</span><span class="o">.</span><span class="n">crs</span><span class="p">(),</span> <span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">,</span> <span class="n">onlySelected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
<span class="k">def</span> <span class="nf">genera_reglas_txt</span><span class="p">(</span><span class="n">p_layer</span><span class="p">,</span><span class="n">campo_cat</span><span class="p">,</span><span class="n">campo_id</span><span class="p">):</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">p_layer</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">consulta</span> <span class="o">=</span> <span class="n">QgsFeatureRequest</span><span class="p">()</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QgsFeatureRequest</span><span class="o">.</span><span class="n">NoGeometry</span><span class="p">)</span>
    <span class="n">lista_cat</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([(</span><span class="n">x</span><span class="p">[</span><span class="n">campo_id</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">campo_cat</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">(</span><span class="n">consulta</span><span class="p">)]))</span>

    <span class="n">lista_cat</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">n_cats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lista_cat</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;generando archivo txt de categorias...&#39;</span><span class="p">)</span>
    <span class="n">path_tp_reglas</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">source</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/reglas_&quot;</span><span class="o">+</span><span class="n">layer</span><span class="o">.</span><span class="n">source</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.txt&quot;</span>
    <span class="n">reglas</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_tp_reglas</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista_cat</span><span class="p">:</span>
        <span class="n">reglas</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">cat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;archivo txt de categorias generado&#39;</span><span class="p">)</span>
    <span class="n">reglas</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">path_tp_reglas</span><span class="p">,</span><span class="n">n_cats</span>
<span class="k">def</span> <span class="nf">agrega_regla_txt</span><span class="p">(</span><span class="n">path_reglas</span><span class="p">,</span><span class="n">lista_cats</span><span class="p">):</span>
    <span class="n">reglas</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_reglas</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista_cats</span><span class="p">:</span>
        <span class="n">reglas</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">cat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;categorias agregadas&#39;</span><span class="p">)</span>
    <span class="n">reglas</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">categorias_generales</span><span class="p">(</span><span class="n">p_capa</span><span class="p">,</span><span class="n">campo_cat</span><span class="p">,</span><span class="n">campo_id</span><span class="p">):</span>
    
    <span class="n">layer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">p_capa</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">consulta</span> <span class="o">=</span> <span class="n">QgsFeatureRequest</span><span class="p">()</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QgsFeatureRequest</span><span class="o">.</span><span class="n">NoGeometry</span><span class="p">)</span>
    <span class="n">lista_cat</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([(</span><span class="n">x</span><span class="p">[</span><span class="n">campo_id</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">campo_cat</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">(</span><span class="n">consulta</span><span class="p">)]))</span>
    <span class="n">lista_cat</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">dicc</span> <span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista_cat</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">cat</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">dicc</span><span class="p">[</span><span class="n">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">cat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dicc</span>
<span class="k">def</span> <span class="nf">selecciona_categorias</span><span class="p">(</span><span class="n">dicc</span><span class="p">,</span><span class="n">lista_ids</span><span class="p">,</span><span class="n">path_v</span><span class="p">,</span><span class="n">campo_cat</span><span class="p">,</span><span class="n">nuevo_int_cats</span><span class="o">=</span><span class="s1">&#39;cats_s&#39;</span><span class="p">,</span><span class="n">cont</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dicc2</span> <span class="o">=</span> <span class="n">dicc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">lista_ids</span><span class="p">:</span>
        <span class="n">dicc2</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_v</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="n">campos</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
    <span class="n">consulta</span> <span class="o">=</span> <span class="n">QgsFeatureRequest</span><span class="p">()</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QgsFeatureRequest</span><span class="o">.</span><span class="n">NoGeometry</span><span class="p">)</span>
    <span class="c1">#lista = list(set([i[campo_cat] for i in vlayer.getFeatures(consulta)]))</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dicc2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    
    <span class="n">lista</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span> <span class="c1"># Ordena las categorias alfabeticamente </span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lista</span><span class="p">)</span>
    <span class="n">n_cats</span> <span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">nuevo_int_cats</span> <span class="ow">in</span> <span class="n">campos</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;el campo ya existe, se actualiza el contenido&#39;</span><span class="p">)</span>

        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
                <span class="n">l</span><span class="p">[</span><span class="n">nuevo_int_cats</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
                <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>

        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">campo_cat</span><span class="p">]:</span>
                    <span class="n">l</span><span class="p">[</span><span class="n">nuevo_int_cats</span><span class="p">]</span><span class="o">=</span><span class="n">cont</span>
                    <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">cont</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="n">nuevo_int_cats</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span><span class="n">QVariant</span><span class="o">.</span><span class="n">Int</span><span class="p">)])</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">campo_cat</span><span class="p">]:</span>
                    <span class="n">l</span><span class="p">[</span><span class="n">nuevo_int_cats</span><span class="p">]</span><span class="o">=</span><span class="n">cont</span>
                    <span class="n">vlayer</span><span class="o">.</span><span class="n">updateFeature</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">cont</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="n">vlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;capa clasificada...&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;generando archivo txt de categorias...&#39;</span><span class="p">)</span>
    <span class="n">path_tp_reglas</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/reglas_cat_selec_&quot;</span><span class="o">+</span><span class="n">path_v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.txt&quot;</span>
    <span class="n">reglas</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_tp_reglas</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">reglas</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="s2">&quot;Ausencia&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cont</span><span class="p">):</span>
        <span class="n">reglas</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">reglas</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">path_tp_reglas</span><span class="p">,</span><span class="n">n_cats</span>

<span class="c1">######## FUNCIONES A DATOS RASTER ###########</span>
<div class="viewcode-block" id="rasterizar_vector"><a class="viewcode-back" href="../apcsig.html#apcsig.rasterizar_vector">[documentos]</a><span class="k">def</span> <span class="nf">rasterizar_vector</span> <span class="p">(</span><span class="n">path_vector</span><span class="p">,</span><span class="n">n_campo</span><span class="p">,</span><span class="n">region</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">tipo</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="n">ancho</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">alto</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función rasteriza una capa vectorial a partir de un campo de tipo numérico y dada una región </span>
<span class="sd">    y el numero de columnas (ancho) y el numero de renglones (alto)</span>

<span class="sd">    :param path_vector: ruta de la capa vectorial</span>
<span class="sd">    :type path_vector: str</span>

<span class="sd">    :param n_campo: nombre del campo que contiene los id de las categorias </span>
<span class="sd">    :type  n_campo: srt</span>

<span class="sd">    :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">    :type region: str</span>

<span class="sd">    :param path_salida: ruta de la capa de salida con extension tif</span>
<span class="sd">    :type path_salida: str</span>

<span class="sd">    :param tipo: tipo de dato, use &#39;int&#39; para entero o &#39;float&#39; para flotante, por default es entero</span>
<span class="sd">    :type tipo: str</span>

<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">path_vector</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
        <span class="n">v_tipo</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># valor para especificar entero a 32 bits</span>
    <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
        <span class="n">v_tipo</span> <span class="o">=</span><span class="mi">5</span> <span class="c1"># valor para flotante </span>

    <span class="n">dicc</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">vector</span><span class="p">,</span>
        <span class="s1">&#39;FIELD&#39;</span><span class="p">:</span><span class="n">n_campo</span><span class="p">,</span>
        <span class="s1">&#39;BURN&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;UNITS&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;WIDTH&#39;</span><span class="p">:</span><span class="n">ancho</span><span class="p">,</span> 
        <span class="s1">&#39;HEIGHT&#39;</span><span class="p">:</span><span class="n">alto</span><span class="p">,</span>
        <span class="s1">&#39;EXTENT&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">,</span>
        <span class="s1">&#39;NODATA&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">9999.0</span><span class="p">,</span>
        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span><span class="s1">&#39;COMPRESS=LZW&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DATA_TYPE&#39;</span><span class="p">:</span><span class="n">v_tipo</span><span class="p">,</span>
        <span class="s1">&#39;INIT&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;INVERT&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;gdal:rasterize&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="rasterizar_vector_directo"><a class="viewcode-back" href="../apcsig.html#apcsig.rasterizar_vector_directo">[documentos]</a><span class="k">def</span> <span class="nf">rasterizar_vector_directo</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span><span class="n">n_campo</span><span class="p">,</span><span class="n">region</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">tipo</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="n">ancho</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">alto</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función rasteriza una capa vectorial a partir de un campo de tipo numérico y dada una región </span>
<span class="sd">    y el numero de columnas (ancho) y el numero de renglones (alto)</span>

<span class="sd">    :param path_vector: ruta de la capa vectorial</span>
<span class="sd">    :type path_vector: str</span>

<span class="sd">    :param n_campo: nombre del campo que contiene los id de las categorias </span>
<span class="sd">    :type  n_campo: srt</span>

<span class="sd">    :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">    :type region: str</span>

<span class="sd">    :param path_salida: ruta de la capa de salida con extension tif</span>
<span class="sd">    :type path_salida: str</span>

<span class="sd">    :param tipo: tipo de dato, use &#39;int&#39; para entero o &#39;float&#39; para flotante, por default es entero</span>
<span class="sd">    :type tipo: str</span>

<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
        <span class="n">v_tipo</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># valor para especificar entero a 32 bits</span>
    <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
        <span class="n">v_tipo</span> <span class="o">=</span><span class="mi">5</span> <span class="c1"># valor para flotante </span>

    <span class="n">dicc</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">vector</span><span class="p">,</span>
        <span class="s1">&#39;FIELD&#39;</span><span class="p">:</span><span class="n">n_campo</span><span class="p">,</span>
        <span class="s1">&#39;BURN&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;UNITS&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;WIDTH&#39;</span><span class="p">:</span><span class="n">ancho</span><span class="p">,</span> 
        <span class="s1">&#39;HEIGHT&#39;</span><span class="p">:</span><span class="n">alto</span><span class="p">,</span>
        <span class="s1">&#39;EXTENT&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">,</span>
        <span class="s1">&#39;NODATA&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">9999.0</span><span class="p">,</span>
        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span><span class="s1">&#39;COMPRESS=LZW&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DATA_TYPE&#39;</span><span class="p">:</span><span class="n">v_tipo</span><span class="p">,</span>
        <span class="s1">&#39;INIT&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;INVERT&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;gdal:rasterize&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="alinear_raster"><a class="viewcode-back" href="../apcsig.html#apcsig.alinear_raster">[documentos]</a><span class="k">def</span> <span class="nf">alinear_raster</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="n">region</span><span class="p">,</span><span class="n">resolucion</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">crs_destino</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">tipo</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función alinea un raster dada una región y el tamaño de pixel </span>
<span class="sd">    :param path_raster: ruta de la capa a alinear</span>
<span class="sd">    :type path_raster: str</span>

<span class="sd">    :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">    :type region: str </span>

<span class="sd">    :param resolucion: tamaño de pixel</span>
<span class="sd">    :type resolucion: int </span>

<span class="sd">    :param path_salida: ruta de la capa de salida con extension tif</span>
<span class="sd">    :type path_salida: str</span>

<span class="sd">    :param crs_destino: nombre del código EPSG,</span>
<span class="sd">    :type crs_destino:  str </span>

<span class="sd">    :param tipo: tipo de dato, use &#39;int&#39; para entero o &#39;float&#39; para flotante, por default es entero</span>
<span class="sd">    :type tipo: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
        <span class="n">v_tipo</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># valor para especificar entero a 32bits</span>
    <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
        <span class="n">v_tipo</span> <span class="o">=</span><span class="mi">6</span> <span class="c1"># valor para flotante </span>

    <span class="k">if</span> <span class="n">crs_destino</span> <span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">crs_destino</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">crs</span><span class="p">()</span>

    <span class="n">dicc</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">path_raster</span><span class="p">,</span>
        <span class="s1">&#39;SOURCE_CRS&#39;</span><span class="p">:</span><span class="n">QgsRasterLayer</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">crs</span><span class="p">(),</span>
        <span class="s1">&#39;TARGET_CRS&#39;</span><span class="p">:</span><span class="n">crs_destino</span><span class="p">,</span>
        <span class="s1">&#39;RESAMPLING&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;NODATA&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">9999</span><span class="p">,</span>
        <span class="s1">&#39;TARGET_RESOLUTION&#39;</span><span class="p">:</span><span class="n">resolucion</span><span class="p">,</span>
        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span><span class="s1">&#39;COMPRESS=LZW&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DATA_TYPE&#39;</span><span class="p">:</span><span class="n">v_tipo</span><span class="p">,</span>
        <span class="s1">&#39;TARGET_EXTENT&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;TARGET_EXTENT_CRS&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;MULTITHREADING&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;gdal:warpreproject&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="aplica_mascara"><a class="viewcode-back" href="../apcsig.html#apcsig.aplica_mascara">[documentos]</a><span class="k">def</span> <span class="nf">aplica_mascara</span><span class="p">(</span><span class="n">path_mascara</span><span class="p">,</span> <span class="n">path_capa</span><span class="p">,</span> <span class="n">path_salida</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función aplica la máscara de la zona de estudio a una capa raster, </span>
<span class="sd">    es importante que la capa a la cual se aplicará la máscara este previamente alineada</span>

<span class="sd">    :param path_mascara: ruta de la mascara en formato tiff</span>
<span class="sd">    :type path_mascara: str</span>


<span class="sd">    :param path_capa: ruta de la capa a la cual se requiere aplicar la máscara</span>
<span class="sd">    :type path_capa: str</span>

<span class="sd">    :param path_salida: ruta de la capa resultado de aplicar la máscara</span>
<span class="sd">    :type path_salida: str</span>

<span class="sd">    :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">    :type region: str</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_mascara</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">path_capa</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="s1">&#39;A*B&#39;</span><span class="p">,</span>
    <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="get_region"><a class="viewcode-back" href="../apcsig.html#apcsig.get_region">[documentos]</a><span class="k">def</span> <span class="nf">get_region</span><span class="p">(</span><span class="n">path_layer</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función extrae la región o extensión de una capa raster así como el número de columnas y renglones</span>

<span class="sd">    :param path_layer: ruta de la capa raster</span>
<span class="sd">    :type path_layer: str</span>

<span class="sd">    :returns: en forma de lista [1,2,3] [1] las coordenadas de la extensión de una capa raster xmin,xmax,ymin,ymax ; [2]. ancho de una capa raster (número de columnas) y [3]. alto de una capa raster (número de renglones)</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">layer</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span><span class="n">path_layer</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">extent</span><span class="p">()</span>
    <span class="n">xmin</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">xMinimum</span><span class="p">()</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">xMaximum</span><span class="p">()</span>
    <span class="n">ymin</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">yMinimum</span><span class="p">()</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">yMaximum</span><span class="p">()</span>

    <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%f</span><span class="s2">,</span><span class="si">%f</span><span class="s2">,</span><span class="si">%f</span><span class="s2">,</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="n">ancho</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
    <span class="n">alto</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">region</span><span class="p">,</span><span class="n">ancho</span><span class="p">,</span><span class="n">alto</span><span class="p">]</span></div>
<div class="viewcode-block" id="ecuacion_clp"><a class="viewcode-back" href="../apcsig.html#apcsig.ecuacion_clp">[documentos]</a><span class="k">def</span> <span class="nf">ecuacion_clp</span><span class="p">(</span><span class="n">pesos</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función recibe una lista de pesos para regresar la ecuación de la combinación líneal ponderada</span>
<span class="sd">    en la estructura requerida para la calculadora raster de gdal.</span>

<span class="sd">    La ecuación líneal ponderada (clp), donde i es el número de capas; x es la capa ráster y w es el peso asociado en el modelo multicriterio</span>
<span class="sd">    para esa capa ráster.</span>

<span class="sd">    .. math:: </span>
<span class="sd">    </span>
<span class="sd">        clp = \sum_{i=i}^{i=n}x_{i}*w_{i}</span>

<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    **ejemplo:**</span>

<span class="sd">    El modelo multicriterio se compone cuatro criterios: **A**, **B**, **C** y **D** ; </span>

<span class="sd">    donde **A** tiene un peso de w=0.40 ; **B** tiene un peso de w=0.25, **C** tiene un peso de w=0.15 u **D** tiene un peso de w=0.20</span>

<span class="sd">    </span>
<span class="sd">    .. math::</span>

<span class="sd">        clp = A*0.40 + B*0.25 + C*0.15 +D*0.20</span>
<span class="sd">    </span>
<span class="sd">    .. note::</span>

<span class="sd">        El orden de los valores en la lista de los pesos tiene que ser igual al orden de la lista de la variable rasters_input de la función</span>
<span class="sd">        crea_capa_raster</span>

<span class="sd">    :param pesos: lista de los pesos de las capas, salida de la función </span>
<span class="sd">    :type pesos: lista</span>

<span class="sd">    :returns: ecuación en formato gdal para ser ingresada a la funcion crea_capa_raster</span>
<span class="sd">    :type returns: str</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">n_variables</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pesos</span><span class="p">)</span>
    <span class="n">abc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)</span>
    <span class="n">ecuacion</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_variables</span><span class="p">),</span><span class="n">pesos</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">n_variables</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ecuacion</span><span class="o">+=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39; * &#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">abc</span><span class="p">[</span><span class="n">a</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; + &#39;</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ecuacion</span><span class="o">+=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39; * &#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">abc</span><span class="p">[</span><span class="n">a</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">ecuacion</span></div>
<div class="viewcode-block" id="normailiza_raster"><a class="viewcode-back" href="../apcsig.html#apcsig.normailiza_raster">[documentos]</a><span class="k">def</span> <span class="nf">normailiza_raster</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span> <span class="n">path_raster_n</span><span class="p">,</span><span class="n">modo</span><span class="o">=</span><span class="s1">&#39;ideales&#39;</span><span class="p">,</span><span class="n">decimales</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función normaliza una capa raster, se puede elegir entre dos tipos de normalización.</span>

<span class="sd">    1) ideales: La capa ráster se divide entre el valor máximo como resultado se tiene una capa con un máximo de 1 pero el valor mínimo no necesariamente será 0</span>

<span class="sd">    .. math:: </span>

<span class="sd">        ideales=\\frac{A}{max(A)}</span>
<span class="sd">    </span>
<span class="sd">    2) lineal: la capa ráster resultante tendra como valor máximo 1 y como valor mínimo 0</span>
<span class="sd">    el 1 representará el maximo de la capa de entrada y el 0 representa el valor mínimo de la </span>
<span class="sd">    capa de entrada</span>

<span class="sd">    .. math::</span>

<span class="sd">        lineal=\\frac{A -min(A)}{max(A) - min(A)}</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="nb">min</span><span class="p">,</span><span class="nb">max</span> <span class="o">=</span> <span class="n">raster_min_max</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>
    <span class="n">no_data</span> <span class="o">=</span><span class="n">raster_nodata</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">modo</span> <span class="o">==</span> <span class="s1">&#39;ideales&#39;</span><span class="p">:</span>
        <span class="n">ec_norm</span> <span class="o">=</span><span class="s1">&#39;(A&#39;</span> <span class="o">+</span> <span class="s1">&#39;) / (&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;)&#39;</span>  <span class="c1"># llevar a ideal </span>
    <span class="k">elif</span> <span class="n">modo</span> <span class="o">==</span> <span class="s1">&#39;lineal&#39;</span><span class="p">:</span>
        <span class="n">ec_norm</span> <span class="o">=</span><span class="s1">&#39;(A - &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;) / (&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;)&#39;</span>  <span class="c1"># normalizar </span>
    
    <span class="n">calculadora_grass</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span> <span class="n">ec_norm</span><span class="p">,</span><span class="n">path_raster_n</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_raw.tif&quot;</span><span class="p">)</span>
    
    <span class="n">redondea_raster</span><span class="p">(</span><span class="n">path_raster_n</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_raw.tif&quot;</span><span class="p">,</span><span class="n">path_raster_n</span><span class="p">,</span><span class="n">decimales</span><span class="p">)</span>
    <span class="n">remove_raster</span><span class="p">(</span><span class="n">path_raster_n</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_raw.tif&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="raster_min_max"><a class="viewcode-back" href="../apcsig.html#apcsig.raster_min_max">[documentos]</a><span class="k">def</span> <span class="nf">raster_min_max</span><span class="p">(</span><span class="n">path_raster</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta funcion regresa los valores maximos y minimos de una capa raster</span>

<span class="sd">    :param path_raster: ruta de la capa raster</span>
<span class="sd">    :type path_raster: str </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rlayer</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">)</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="n">rlayer</span><span class="o">.</span><span class="n">extent</span><span class="p">()</span>
    <span class="n">provider</span> <span class="o">=</span> <span class="n">rlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">bandStatistics</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">QgsRasterBandStats</span><span class="o">.</span><span class="n">All</span><span class="p">,</span>
                                    <span class="n">extent</span><span class="p">,</span>
                                    <span class="mi">0</span><span class="p">)</span>

    <span class="n">v_min</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">minimumValue</span>
    <span class="n">v_max</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">maximumValue</span>
    <span class="k">return</span> <span class="n">v_min</span><span class="p">,</span> <span class="n">v_max</span></div>
<div class="viewcode-block" id="redondea_raster"><a class="viewcode-back" href="../apcsig.html#apcsig.redondea_raster">[documentos]</a><span class="k">def</span> <span class="nf">redondea_raster</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="n">salida</span><span class="p">,</span><span class="n">no_decimales</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función redondea una capa raster de tipo flotante en el número de decimales indicado</span>

<span class="sd">    :param path_raster: ruta de la capa raster</span>
<span class="sd">    :type path_raster: str</span>

<span class="sd">    :param no_decimales: número de decimales a los que se va a redondear la capa, por default es 3</span>
<span class="sd">    :type no_decimaes: int</span>

<span class="sd">    :param salida: ruta de la capa de salida</span>
<span class="sd">    :type salida: str</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dicc</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;INPUT_A&#39;</span><span class="p">:</span><span class="n">path_raster</span><span class="p">,</span>
                <span class="s1">&#39;BAND_A&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;INPUT_B&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;BAND_B&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;INPUT_C&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;BAND_C&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;INPUT_D&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;BAND_D&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;INPUT_E&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;BAND_E&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;INPUT_F&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;BAND_F&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;FORMULA&#39;</span><span class="p">:</span><span class="s1">&#39;A.round(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">no_decimales</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;NO_DATA&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">9999.0</span><span class="p">,</span>
                <span class="s1">&#39;RTYPE&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;EXTRA&#39;</span><span class="p">:</span><span class="s1">&#39;--co=</span><span class="se">\&quot;</span><span class="s1">COMPRESS=LZW</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;gdal:rastercalculator&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="crea_capa_raster"><a class="viewcode-back" href="../apcsig.html#apcsig.crea_capa_raster">[documentos]</a><span class="k">def</span> <span class="nf">crea_capa_raster</span><span class="p">(</span><span class="n">ecuacion</span><span class="p">,</span><span class="n">rasters_input</span><span class="p">,</span><span class="n">salida</span><span class="p">,</span><span class="n">decimales</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span> 

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función crea una capa mediante la calculadora raster</span>
<span class="sd">    de GDAL, esta función esta limitada hasta 14 variables en la ecuación.</span>

<span class="sd">    :param ecuacion: ecuación expresada en formato gdal,</span>
<span class="sd">    :type ecuacion: str</span>
<span class="sd">    :param rasters_input: lista de los paths de los archivos rasters</span>
<span class="sd">    :type rasters_input: list</span>
<span class="sd">    :param salida: ruta con extensión tiff de la salida</span>
<span class="sd">    :type salida: str</span>

<span class="sd">    :returns: Capa raster de tipo flotante, los valores de la capa son redondeados a 3 decimales</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">path_A</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_B</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_C</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_D</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_E</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_F</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_G</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_H</span><span class="o">=</span><span class="s1">&#39;&#39;</span>  
    <span class="n">path_I</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_J</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_K</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_L</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_M</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_N</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_O</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_P</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_Q</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_R</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_S</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_T</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_U</span><span class="o">=</span><span class="s1">&#39;&#39;</span>  
    <span class="n">path_V</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_W</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_X</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_Y</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">path_Z</span><span class="o">=</span><span class="s1">&#39;&#39;</span>



    <span class="n">total_raster</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rasters_input</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">total_raster</span><span class="p">),</span> <span class="n">rasters_input</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">path_A</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">path_B</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">path_C</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">path_D</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">path_E</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">path_F</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">path_G</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">path_H</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">path_I</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">path_J</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">path_K</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="n">path_L</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">path_M</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
            <span class="n">path_N</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">path_O</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
            <span class="n">path_P</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">path_Q</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>
            <span class="n">path_R</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">18</span><span class="p">:</span>
            <span class="n">path_S</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>
            <span class="n">path_T</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">path_U</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">path_V</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">22</span><span class="p">:</span>
            <span class="n">path_W</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">23</span><span class="p">:</span>
            <span class="n">path_X</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">24</span><span class="p">:</span>
            <span class="n">path_Y</span><span class="o">=</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
            <span class="n">path_Z</span><span class="o">=</span><span class="n">b</span>
    <span class="n">tp_salida</span> <span class="o">=</span><span class="n">salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_raw.tif&quot;</span>
     
    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        
    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        
    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        
    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                            
    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">18</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">T</span><span class="o">=</span><span class="n">path_T</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">T</span><span class="o">=</span><span class="n">path_T</span><span class="p">,</span>
                        <span class="n">U</span><span class="o">=</span><span class="n">path_U</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">22</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">T</span><span class="o">=</span><span class="n">path_T</span><span class="p">,</span>
                        <span class="n">U</span><span class="o">=</span><span class="n">path_U</span><span class="p">,</span>
                        <span class="n">V</span><span class="o">=</span><span class="n">path_V</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">23</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">T</span><span class="o">=</span><span class="n">path_T</span><span class="p">,</span>
                        <span class="n">U</span><span class="o">=</span><span class="n">path_U</span><span class="p">,</span>
                        <span class="n">V</span><span class="o">=</span><span class="n">path_V</span><span class="p">,</span>
                        <span class="n">W</span><span class="o">=</span><span class="n">path_W</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">24</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">T</span><span class="o">=</span><span class="n">path_T</span><span class="p">,</span>
                        <span class="n">U</span><span class="o">=</span><span class="n">path_U</span><span class="p">,</span>
                        <span class="n">V</span><span class="o">=</span><span class="n">path_V</span><span class="p">,</span>
                        <span class="n">W</span><span class="o">=</span><span class="n">path_W</span><span class="p">,</span>
                        <span class="n">X</span><span class="o">=</span><span class="n">path_X</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">T</span><span class="o">=</span><span class="n">path_T</span><span class="p">,</span>
                        <span class="n">U</span><span class="o">=</span><span class="n">path_U</span><span class="p">,</span>
                        <span class="n">V</span><span class="o">=</span><span class="n">path_V</span><span class="p">,</span>
                        <span class="n">W</span><span class="o">=</span><span class="n">path_W</span><span class="p">,</span>
                        <span class="n">X</span><span class="o">=</span><span class="n">path_X</span><span class="p">,</span>
                        <span class="n">Y</span><span class="o">=</span><span class="n">path_Y</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total_raster</span> <span class="o">==</span> <span class="mi">26</span><span class="p">:</span>
        <span class="n">gdal_calc</span><span class="o">.</span><span class="n">Calc</span><span class="p">(</span><span class="n">calc</span><span class="o">=</span><span class="n">ecuacion</span><span class="p">,</span> 
                        <span class="n">A</span><span class="o">=</span><span class="n">path_A</span><span class="p">,</span> 
                        <span class="n">B</span><span class="o">=</span><span class="n">path_B</span><span class="p">,</span>
                        <span class="n">C</span><span class="o">=</span><span class="n">path_C</span><span class="p">,</span> 
                        <span class="n">D</span><span class="o">=</span><span class="n">path_D</span><span class="p">,</span>
                        <span class="n">E</span><span class="o">=</span><span class="n">path_E</span><span class="p">,</span> 
                        <span class="n">F</span><span class="o">=</span><span class="n">path_F</span><span class="p">,</span>
                        <span class="n">G</span><span class="o">=</span><span class="n">path_G</span><span class="p">,</span> 
                        <span class="n">H</span><span class="o">=</span><span class="n">path_H</span><span class="p">,</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">path_I</span><span class="p">,</span>
                        <span class="n">J</span><span class="o">=</span><span class="n">path_J</span><span class="p">,</span>
                        <span class="n">K</span><span class="o">=</span><span class="n">path_K</span><span class="p">,</span>
                        <span class="n">L</span><span class="o">=</span><span class="n">path_L</span><span class="p">,</span>
                        <span class="n">M</span><span class="o">=</span><span class="n">path_M</span><span class="p">,</span>
                        <span class="n">N</span><span class="o">=</span><span class="n">path_N</span><span class="p">,</span>
                        <span class="n">O</span><span class="o">=</span><span class="n">path_O</span><span class="p">,</span>
                        <span class="n">P</span><span class="o">=</span><span class="n">path_P</span><span class="p">,</span>
                        <span class="n">Q</span><span class="o">=</span><span class="n">path_Q</span><span class="p">,</span>
                        <span class="n">R</span><span class="o">=</span><span class="n">path_R</span><span class="p">,</span>
                        <span class="n">S</span><span class="o">=</span><span class="n">path_S</span><span class="p">,</span>
                        <span class="n">T</span><span class="o">=</span><span class="n">path_T</span><span class="p">,</span>
                        <span class="n">U</span><span class="o">=</span><span class="n">path_U</span><span class="p">,</span>
                        <span class="n">V</span><span class="o">=</span><span class="n">path_V</span><span class="p">,</span>
                        <span class="n">W</span><span class="o">=</span><span class="n">path_W</span><span class="p">,</span>
                        <span class="n">X</span><span class="o">=</span><span class="n">path_X</span><span class="p">,</span>
                        <span class="n">Y</span><span class="o">=</span><span class="n">path_Y</span><span class="p">,</span>
                        <span class="n">Z</span><span class="o">=</span><span class="n">path_Z</span><span class="p">,</span>
                        <span class="n">outfile</span><span class="o">=</span><span class="n">tp_salida</span><span class="p">,</span>
                        <span class="n">NoDataValue</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span>
                        <span class="c1">#creation_options=[&quot;COMPRESS=LZW&quot;,&quot;PREDICTOR=3&quot;,&quot;TILED=YES&quot;],</span>
                        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="n">redondea_raster</span><span class="p">(</span><span class="n">tp_salida</span><span class="p">,</span><span class="n">salida</span><span class="p">,</span><span class="n">decimales</span><span class="p">)</span>
    <span class="n">remove_raster</span><span class="p">(</span><span class="n">tp_salida</span><span class="p">)</span></div>
<div class="viewcode-block" id="remove_raster"><a class="viewcode-back" href="../apcsig.html#apcsig.remove_raster">[documentos]</a><span class="k">def</span> <span class="nf">remove_raster</span><span class="p">(</span><span class="n">path_r</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función elimina una capa del sistema</span>

<span class="sd">    :param path_r: ruta de la capa </span>
<span class="sd">    :type path_r: str</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_r</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])):</span>
        <span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre_capa</span><span class="p">(</span><span class="n">path_r</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nombre</span> <span class="ow">in</span>  <span class="n">extension</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="ow">and</span> <span class="n">nombre</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">==</span><span class="n">extension</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span>
                <span class="n">arch</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">root</span><span class="p">,</span><span class="n">name</span><span class="p">])</span>
                <span class="n">lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arch</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">arch</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">arch</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no se elimino &#39;</span><span class="p">,</span><span class="n">arch</span><span class="p">)</span></div>
<div class="viewcode-block" id="asignar_nulls"><a class="viewcode-back" href="../apcsig.html#apcsig.asignar_nulls">[documentos]</a><span class="k">def</span> <span class="nf">asignar_nulls</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">valor_huecos</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función asigna un valor  a los no_data de la capa</span>
<span class="sd">    </span>
<span class="sd">    :param map: ruta de la capa raster</span>
<span class="sd">    :type map: str</span>

<span class="sd">    :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">    :type region: str</span>

<span class="sd">    :param output:ruta de la capa resultante</span>
<span class="sd">    :type output: str</span>

<span class="sd">    :param valor_huecos: número que tendrán los pixeles nulos</span>
<span class="sd">    :type valor_huecos: int </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">region</span><span class="o">=</span><span class="n">get_region</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
    <span class="n">dicc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;map&#39;</span><span class="p">:</span><span class="nb">map</span><span class="p">,</span>
            <span class="s1">&#39;setnull&#39;</span><span class="p">:</span><span class="n">valor_huecos</span><span class="p">,</span>
            <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">output</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.null&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="nulls"><a class="viewcode-back" href="../apcsig.html#apcsig.nulls">[documentos]</a><span class="k">def</span> <span class="nf">nulls</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">valor_huecos</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función asigna un valor  a los no_data de la capa</span>
<span class="sd">    </span>
<span class="sd">    :param map: ruta de la capa raster</span>
<span class="sd">    :type map: str</span>

<span class="sd">    :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">    :type region: str</span>

<span class="sd">    :param output:ruta de la capa resultante</span>
<span class="sd">    :type output: str</span>

<span class="sd">    :param valor_huecos: número que tendrán los pixeles nulos</span>
<span class="sd">    :type valor_huecos: int </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">region</span><span class="o">=</span><span class="n">get_region</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
    <span class="n">dicc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;map&#39;</span><span class="p">:</span><span class="nb">map</span><span class="p">,</span>
            <span class="s1">&#39;null&#39;</span><span class="p">:</span><span class="n">valor_huecos</span><span class="p">,</span>
            <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">output</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.null&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span></div>
<span class="k">def</span> <span class="nf">raster_1capa</span><span class="p">(</span><span class="n">path_a</span><span class="p">,</span><span class="n">ecuacion</span><span class="p">,</span><span class="n">salida</span><span class="p">,</span><span class="n">tipo</span> <span class="o">=</span> <span class="s1">&#39;int&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;byte&#39;</span><span class="p">:</span>
        <span class="n">r_type</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
        <span class="n">r_type</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
        <span class="n">r_type</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">dicc</span> <span class="o">=</span><span class="p">{</span>        
        <span class="s1">&#39;INPUT_A&#39;</span><span class="p">:</span><span class="n">path_a</span><span class="p">,</span>
        <span class="s1">&#39;BAND_A&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;FORMULA&#39;</span><span class="p">:</span><span class="n">ecuacion</span><span class="p">,</span>
        <span class="s1">&#39;NO_DATA&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span>
        <span class="s1">&#39;RTYPE&#39;</span><span class="p">:</span><span class="n">r_type</span><span class="p">,</span>
        <span class="s1">&#39;EXTRA&#39;</span><span class="p">:</span><span class="s1">&#39;--co=&quot;COMPRESS=LZW&quot;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;gdal:rastercalculator&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">raster_2capas</span><span class="p">(</span><span class="n">path_a</span><span class="p">,</span><span class="n">path_b</span><span class="p">,</span><span class="n">ecuacion</span><span class="p">,</span><span class="n">salida</span><span class="p">,</span><span class="n">tipo</span> <span class="o">=</span> <span class="s1">&#39;int&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
        <span class="n">r_type</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">tipo</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
        <span class="n">r_type</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">dicc</span> <span class="o">=</span><span class="p">{</span>        
        <span class="s1">&#39;INPUT_A&#39;</span><span class="p">:</span><span class="n">path_a</span><span class="p">,</span>
        <span class="s1">&#39;BAND_A&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;INPUT_B&#39;</span><span class="p">:</span><span class="n">path_b</span><span class="p">,</span>
        <span class="s1">&#39;BAND_B&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;FORMULA&#39;</span><span class="p">:</span><span class="n">ecuacion</span><span class="p">,</span>
        <span class="s1">&#39;NO_DATA&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span>
        <span class="s1">&#39;RTYPE&#39;</span><span class="p">:</span><span class="n">r_type</span><span class="p">,</span>
        <span class="s1">&#39;EXTRA&#39;</span><span class="p">:</span><span class="s1">&#39;--co=&quot;COMPRESS=LZW&quot;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;gdal:rastercalculator&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span>
<div class="viewcode-block" id="reclasifica_capa"><a class="viewcode-back" href="../apcsig.html#apcsig.reclasifica_capa">[documentos]</a><span class="k">def</span> <span class="nf">reclasifica_capa</span><span class="p">(</span><span class="n">capa</span><span class="p">,</span><span class="n">region</span><span class="p">,</span><span class="n">reglas</span><span class="p">,</span><span class="n">salida</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función permite reclasificar una capa raster y genera un archivo </span>
<span class="sd">    xml el cúal contiene el nombre de las categorias.</span>

<span class="sd">    :param capa: ruta de capa de entrada</span>
<span class="sd">    :type capa: str</span>

<span class="sd">    :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">    :type region: str</span>

<span class="sd">    :param reglas: ruta del archivo txt que contiene las reglas de clasificación </span>
<span class="sd">    :type reglas: str</span>

<span class="sd">    :param salida: ruta de la capa de salida reclasificada</span>
<span class="sd">    :type salida: str</span>

<span class="sd">    :retuns: Capa raster clasificada y archivo xml </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;input&#39;</span><span class="p">:</span><span class="n">capa</span><span class="p">,</span>
                    <span class="s1">&#39;rules&#39;</span><span class="p">:</span><span class="n">reglas</span><span class="p">,</span>
                    <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">,</span>
                    <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">,</span>
                    <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                    <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.reclass&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span></div>
<span class="k">def</span> <span class="nf">buffer_raster</span><span class="p">(</span><span class="n">path_r</span><span class="p">,</span><span class="n">distancia</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">path_mascara</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">get_region</span><span class="p">(</span><span class="n">path_mascara</span><span class="p">)</span>
    <span class="n">path_r_distancia</span> <span class="o">=</span> <span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_temp.tif&quot;</span>
    <span class="n">dicc</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;input&#39;</span><span class="p">:</span><span class="n">path_r</span><span class="p">,</span><span class="s1">&#39;distances&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">distancia</span><span class="p">),</span>
    <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;-z&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>  <span class="c1">#0 metros, 1 km</span>
    <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_r_distancia</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">get_region</span><span class="p">(</span><span class="n">path_r</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.buffer&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span>
    <span class="n">dicc_it</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_r_distancia</span><span class="p">,</span>
            <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="s1">&#39;(A&gt;0)*1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_r_distancia</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span><span class="n">dicc_it</span><span class="p">)</span>
    
    <span class="n">nulls</span><span class="p">(</span><span class="n">path_r_distancia</span><span class="p">,</span><span class="n">path_r_distancia</span><span class="p">,</span><span class="n">valor_huecos</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">dicc2</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_mascara</span><span class="p">,</span>
            <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">path_r_distancia</span><span class="p">,</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="s1">&#39;(B)*A&#39;</span><span class="p">,</span>
            <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span><span class="n">dicc2</span><span class="p">)</span>
    <span class="n">remove_raster</span><span class="p">(</span><span class="n">path_r_distancia</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">calcula_distancias_raster</span><span class="p">(</span><span class="n">path_r</span><span class="p">,</span><span class="n">path_mascara</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">tipo_distancia</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">remover</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">get_region</span><span class="p">(</span><span class="n">path_mascara</span><span class="p">)</span>
    <span class="n">path_r_distancia</span> <span class="o">=</span> <span class="n">path_r</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_tp_dis_mts.tif&quot;</span>
    <span class="n">dicc_distance</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;input&#39;</span><span class="p">:</span><span class="n">path_r</span><span class="p">,</span>
    <span class="s1">&#39;metric&#39;</span><span class="p">:</span><span class="n">tipo_distancia</span><span class="p">,</span> <span class="c1"># 0 = distancia euclidiana 3 = manhanthan</span>
    <span class="s1">&#39;-m&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;-&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;distance&#39;</span><span class="p">:</span><span class="n">path_r_distancia</span><span class="p">,</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="s1">&#39;TEMPORARY_OUTPUT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">get_region</span><span class="p">(</span><span class="n">path_r</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.grow.distance&quot;</span><span class="p">,</span><span class="n">dicc_distance</span><span class="p">)</span>
   
    <span class="n">dicc</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_r_distancia</span><span class="p">,</span>
            <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">path_mascara</span><span class="p">,</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="s1">&#39;(round(A/100.0,1)/10.0)*B&#39;</span><span class="p">,</span> <span class="c1">#Expresión que convierte las distancias a kms con un decimal y aplica la mascara de la zona de estudio</span>
            <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remover</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">remove_raster</span><span class="p">(</span><span class="n">path_r_distancia</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;la capa temporal no ha sido eliminada&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="distancia_caminos_lugar"><a class="viewcode-back" href="../apcsig.html#apcsig.distancia_caminos_lugar">[documentos]</a><span class="k">def</span> <span class="nf">distancia_caminos_lugar</span><span class="p">(</span><span class="n">layer_raster_lugar</span><span class="p">,</span><span class="n">path_caminos</span><span class="p">,</span><span class="n">campo_caminos</span><span class="p">,</span><span class="n">path_mascara</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">region_ext</span><span class="p">,</span><span class="n">ancho_ext</span><span class="o">=</span><span class="mi">2292</span><span class="p">,</span><span class="n">alto_ext</span><span class="o">=</span><span class="mi">2284</span><span class="p">,</span><span class="n">remover</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Esta función genera una capa de distancia a caminos y agrega distancia cero a aquellos pixeles que se sobreponen con el área del lugar</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">layer_raster_caminos</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/tp1_&quot;</span><span class="o">+</span><span class="n">nombre_capa</span><span class="p">(</span><span class="n">path_caminos</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.tif&quot;</span>
    <span class="n">tp_distancia_camino</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/tp2_&quot;</span><span class="o">+</span><span class="n">nombre_capa</span><span class="p">(</span><span class="n">path_caminos</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.tif&quot;</span>
    <span class="n">path_presencia_invertida</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/tp1_&quot;</span><span class="o">+</span><span class="n">nombre_capa</span><span class="p">(</span><span class="n">layer_raster_lugar</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.tif&quot;</span> 
    <span class="n">path_presencia_invertida_null1</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;/tp2_&quot;</span><span class="o">+</span><span class="n">nombre_capa</span><span class="p">(</span><span class="n">layer_raster_lugar</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.tif&quot;</span> 

    <span class="n">region_pr</span> <span class="o">=</span> <span class="n">get_region</span><span class="p">(</span><span class="n">path_mascara</span><span class="p">)</span>
    <span class="n">rasterizar_vector</span><span class="p">(</span><span class="n">path_caminos</span><span class="p">,</span><span class="n">campo_caminos</span><span class="p">,</span><span class="n">region_ext</span><span class="p">,</span><span class="n">layer_raster_caminos</span><span class="p">,</span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="n">ancho_ext</span><span class="p">,</span><span class="n">alto_ext</span><span class="p">)</span> <span class="c1"># 1 signigica carretera, 0 ausencia </span>
    <span class="n">calcula_distancias_raster</span><span class="p">(</span><span class="n">layer_raster_caminos</span><span class="p">,</span><span class="n">path_mascara</span><span class="p">,</span><span class="n">tp_distancia_camino</span><span class="p">,</span><span class="n">tipo_distancia</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    
   

    <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">layer_raster_lugar</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="s1">&#39;A-1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_presencia_invertida</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region_pr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span>
    <span class="n">nulls</span><span class="p">(</span><span class="n">path_presencia_invertida</span><span class="p">,</span><span class="n">path_presencia_invertida_null1</span><span class="p">,</span><span class="n">valor_huecos</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">dicc2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_presencia_invertida_null1</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">tp_distancia_camino</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="s1">&#39;A*B&#39;</span><span class="p">,</span>
    <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region_pr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remover</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">remove_raster</span><span class="p">(</span><span class="n">layer_raster_caminos</span><span class="p">)</span>
        <span class="n">remove_raster</span><span class="p">(</span><span class="n">tp_distancia_camino</span><span class="p">)</span>
        <span class="n">remove_raster</span><span class="p">(</span><span class="n">path_presencia_invertida</span><span class="p">)</span>
        <span class="n">remove_raster</span><span class="p">(</span><span class="n">path_presencia_invertida_null1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;las capas temporales no han sido eliminadas&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="calculadora_grass"><a class="viewcode-back" href="../apcsig.html#apcsig.calculadora_grass">[documentos]</a><span class="k">def</span> <span class="nf">calculadora_grass</span><span class="p">(</span><span class="n">path_capa</span><span class="p">,</span> <span class="n">ecuacion</span><span class="p">,</span><span class="n">path_salida</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Esta función aplica la máscara de la zona de estudio</span>

<span class="sd">        :param path_mascara: ruta de la mascara en formato tiff</span>
<span class="sd">        :type path_mascara: str</span>


<span class="sd">        :param path_capa: ruta de la capa a la cual se requiere aplicar la máscara</span>
<span class="sd">        :type path_capa: str</span>

<span class="sd">        :param path_salida: ruta de la capa resultado de aplicar la máscara</span>
<span class="sd">        :type path_salida: str</span>

<span class="sd">        :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">        :type region: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">get_region</span><span class="p">(</span><span class="n">path_capa</span><span class="p">)</span>

        <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_capa</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="n">ecuacion</span><span class="p">,</span>
        <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="calculadora_grass_2capas"><a class="viewcode-back" href="../apcsig.html#apcsig.calculadora_grass_2capas">[documentos]</a><span class="k">def</span> <span class="nf">calculadora_grass_2capas</span><span class="p">(</span><span class="n">path_capa_a</span><span class="p">,</span><span class="n">path_capa_b</span><span class="p">,</span> <span class="n">ecuacion</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">region</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Esta función aplica la máscara de la zona de estudio</span>

<span class="sd">        :param path_mascara: ruta de la mascara en formato tiff</span>
<span class="sd">        :type path_mascara: str</span>


<span class="sd">        :param path_capa: ruta de la capa a la cual se requiere aplicar la máscara</span>
<span class="sd">        :type path_capa: str</span>

<span class="sd">        :param path_salida: ruta de la capa resultado de aplicar la máscara</span>
<span class="sd">        :type path_salida: str</span>

<span class="sd">        :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">        :type region: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
<span class="c1">#        region = get_region(path_capa_a)</span>

        <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_capa_a</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">path_capa_b</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="n">ecuacion</span><span class="p">,</span>
        <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="calculadora_grass_3capas"><a class="viewcode-back" href="../apcsig.html#apcsig.calculadora_grass_3capas">[documentos]</a><span class="k">def</span> <span class="nf">calculadora_grass_3capas</span><span class="p">(</span><span class="n">path_capa_a</span><span class="p">,</span><span class="n">path_capa_b</span><span class="p">,</span><span class="n">path_capa_c</span><span class="p">,</span> <span class="n">ecuacion</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="n">region</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Esta función aplica la máscara de la zona de estudio</span>

<span class="sd">        :param path_mascara: ruta de la mascara en formato tiff</span>
<span class="sd">        :type path_mascara: str</span>


<span class="sd">        :param path_capa: ruta de la capa a la cual se requiere aplicar la máscara</span>
<span class="sd">        :type path_capa: str</span>

<span class="sd">        :param path_salida: ruta de la capa resultado de aplicar la máscara</span>
<span class="sd">        :type path_salida: str</span>

<span class="sd">        :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">        :type region: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
       <span class="c1"># region = get_region(path_capa_a)</span>

        <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_capa_a</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">path_capa_b</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="n">path_capa_c</span><span class="p">,</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="n">ecuacion</span><span class="p">,</span>
        <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="calculadora_grass_4capas"><a class="viewcode-back" href="../apcsig.html#apcsig.calculadora_grass_4capas">[documentos]</a><span class="k">def</span> <span class="nf">calculadora_grass_4capas</span><span class="p">(</span><span class="n">lista_capas</span><span class="p">,</span> <span class="n">ecuacion</span><span class="p">,</span><span class="n">path_salida</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Esta función aplica la máscara de la zona de estudio</span>

<span class="sd">        :param path_mascara: ruta de la mascara en formato tiff</span>
<span class="sd">        :type path_mascara: str</span>


<span class="sd">        :param path_capa: ruta de la capa a la cual se requiere aplicar la máscara</span>
<span class="sd">        :type path_capa: str</span>

<span class="sd">        :param path_salida: ruta de la capa resultado de aplicar la máscara</span>
<span class="sd">        :type path_salida: str</span>

<span class="sd">        :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">        :type region: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">get_region</span><span class="p">(</span><span class="n">lista_capas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">lista_capas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">lista_capas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="n">lista_capas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="n">lista_capas</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="n">ecuacion</span><span class="p">,</span>
        <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">path_salida</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span></div>
<div class="viewcode-block" id="integra_localidades_caminos"><a class="viewcode-back" href="../apcsig.html#apcsig.integra_localidades_caminos">[documentos]</a><span class="k">def</span> <span class="nf">integra_localidades_caminos</span><span class="p">(</span><span class="n">path_lugar_n</span><span class="p">,</span><span class="n">w_lugar</span><span class="p">,</span><span class="n">path_d_camino_n</span><span class="p">,</span><span class="n">w_d_camino</span><span class="p">,</span><span class="n">d_max_lugar</span><span class="p">,</span><span class="n">salida</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Esta función aplica la máscara de la zona de estudio</span>

<span class="sd">        :param path_mascara: ruta de la mascara en formato tiff</span>
<span class="sd">        :type path_mascara: str</span>


<span class="sd">        :param path_capa: ruta de la capa a la cual se requiere aplicar la máscara</span>
<span class="sd">        :type path_capa: str</span>

<span class="sd">        :param path_salida: ruta de la capa resultado de aplicar la máscara</span>
<span class="sd">        :type path_salida: str</span>

<span class="sd">        :param region: coordenadas de la región del estudio  xmin,xmax,ymin,ymax</span>
<span class="sd">        :type region: str</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">get_region</span><span class="p">(</span><span class="n">path_lugar_n</span><span class="p">)</span>
        <span class="n">ecuacion</span>  <span class="o">=</span> <span class="s1">&#39;(A*&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">w_lugar</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; + B *&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">w_d_camino</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) * (&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">d_max_lugar</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
        <span class="n">dicc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">path_lugar_n</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">path_d_camino_n</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;e&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;expression&#39;</span><span class="p">:</span><span class="n">ecuacion</span><span class="p">,</span>
        <span class="s1">&#39;output&#39;</span><span class="p">:</span><span class="n">salida</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_REGION_PARAMETER&#39;</span><span class="p">:</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;GRASS_REGION_CELLSIZE_PARAMETER&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_OPT&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;GRASS_RASTER_FORMAT_META&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;grass7:r.mapcalc.simple&quot;</span><span class="p">,</span> <span class="n">dicc</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;proceso integra_localidades_caminos terminado&quot;</span><span class="p">)</span></div>
<span class="k">def</span> <span class="nf">areas_por_categorias</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="n">path_salida</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">min</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span> <span class="n">raster_min_max</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>
    <span class="n">raster_matrix</span> <span class="o">=</span>  <span class="n">gdalnumeric</span><span class="o">.</span><span class="n">LoadFile</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>
    <span class="n">dicc</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">area_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">total_pixeles_cat</span> <span class="o">=</span> <span class="p">(</span><span class="n">raster_matrix</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> 
        <span class="n">area</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_pixeles_cat</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dicc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="n">area</span>
        <span class="n">area_total</span> <span class="o">+=</span><span class="n">area</span>
    <span class="n">lista_cats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nula&#39;</span><span class="p">,</span><span class="s1">&#39;Muy baja&#39;</span><span class="p">,</span><span class="s1">&#39;Baja&#39;</span><span class="p">,</span><span class="s1">&#39;Moderada&#39;</span><span class="p">,</span><span class="s1">&#39;Alta&#39;</span><span class="p">,</span><span class="s1">&#39;Muy alta&#39;</span><span class="p">]</span>

    <span class="n">archivo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_salida</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dicc</span><span class="p">)</span>
    <span class="n">archivo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Categoría,km²,Porcentaje del estado</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">archivo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">lista_cats</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="nb">str</span><span class="p">(</span><span class="n">dicc</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">dicc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">area_total</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">))])</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">archivo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">arch_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_salida</span><span class="p">)</span>
    
    <span class="n">df_o</span> <span class="o">=</span> <span class="n">arch_csv</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">df_o</span><span class="p">)</span>
    <span class="n">df_o</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span> <span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.xlsx&quot;</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="viewcode-block" id="areas_por_categorias_colsulta"><a class="viewcode-back" href="../apcsig.html#apcsig.areas_por_categorias_colsulta">[documentos]</a><span class="k">def</span> <span class="nf">areas_por_categorias_colsulta</span><span class="p">(</span><span class="n">path_raster</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Ésta función imprime el número de pixeles por categoria de un archivo ráster</span>

<span class="sd">    :param path_raster: ruta del archivo ráster</span>
<span class="sd">    :type path_raster: str</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">valores</span> <span class="o">=</span> <span class="n">categorias_unicas_raster</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>
    <span class="n">raster_matrix</span> <span class="o">=</span>  <span class="n">gdalnumeric</span><span class="o">.</span><span class="n">LoadFile</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categoria | no_pix</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">valores</span><span class="p">:</span>
        <span class="n">total_pixeles_cat</span> <span class="o">=</span> <span class="p">(</span><span class="n">raster_matrix</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> 
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot; | &quot;</span><span class="p">,</span><span class="n">total_pixeles_cat</span><span class="p">)</span></div>
<span class="k">def</span> <span class="nf">raster_nodata</span><span class="p">(</span><span class="n">path_raster</span><span class="p">):</span>

    <span class="n">rlayer</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">)</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="n">rlayer</span><span class="o">.</span><span class="n">extent</span><span class="p">()</span>
    

    <span class="n">provider</span> <span class="o">=</span> <span class="n">rlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">rlayer</span><span class="o">.</span><span class="n">rasterUnitsPerPixelY</span><span class="p">()</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">rlayer</span><span class="o">.</span><span class="n">rasterUnitsPerPixelX</span><span class="p">()</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">block</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">extent</span><span class="p">,</span>  <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>

    <span class="n">no_data</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">noDataValue</span><span class="p">()</span>

    
    <span class="k">return</span> <span class="n">no_data</span>
<span class="k">def</span> <span class="nf">categorias_unicas_raster</span><span class="p">(</span><span class="n">path_raster</span><span class="p">):</span>
    <span class="n">v_nodata</span> <span class="o">=</span> <span class="n">raster_nodata</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>
    <span class="n">raster_matrix</span> <span class="o">=</span> <span class="n">gdalnumeric</span><span class="o">.</span><span class="n">LoadFile</span><span class="p">(</span><span class="n">path_raster</span><span class="p">)</span>


    <span class="n">valores_unicos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">raster_matrix</span><span class="p">))</span>
    <span class="n">valores_unicos</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v_nodata</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;total de categorias&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">valores_unicos</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">valores_unicos</span>
<div class="viewcode-block" id="raster_a_vector"><a class="viewcode-back" href="../apcsig.html#apcsig.raster_a_vector">[documentos]</a><span class="k">def</span> <span class="nf">raster_a_vector</span><span class="p">(</span><span class="n">path_raster</span><span class="p">,</span><span class="n">nombre_campo</span><span class="p">,</span><span class="n">path_vector</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Función que transforma una capa ráster a vector.</span>

<span class="sd">    :param path_raster:Ruta de la capa raster:</span>
<span class="sd">    :type path_raster: str</span>

<span class="sd">    :param nombre_campo: Nombre del campo de la capa vectorial que contendrá los valores o categorias del ráster</span>
<span class="sd">    :type nombre_campo: int</span>

<span class="sd">    :param path_vector: Ruta donde se almacenará la capa shapefile</span>
<span class="sd">    :type path_vector: str</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dicc</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">path_raster</span><span class="p">,</span>
                    <span class="s1">&#39;BAND&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;FIELD&#39;</span><span class="p">:</span><span class="n">nombre_campo</span><span class="p">,</span>
                    <span class="s1">&#39;EIGHT_CONNECTEDNESS&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;EXTRA&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="n">path_vector</span><span class="p">}</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;gdal:polygonize&quot;</span><span class="p">,</span><span class="n">dicc</span><span class="p">)</span></div>
<span class="k">def</span> <span class="nf">max_raster</span><span class="p">(</span><span class="n">lista_capas</span><span class="p">,</span> <span class="n">path_salida</span><span class="p">,</span><span class="n">mascara</span><span class="p">):</span>
    <span class="n">n_variables</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lista_capas</span><span class="p">)</span>
    <span class="n">abc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)</span>
    <span class="n">ecuacion</span> <span class="o">=</span> <span class="s2">&quot;numpy.max((&quot;</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">abc</span><span class="p">[:</span><span class="n">n_variables</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;),axis=0)&quot;</span>
    <span class="n">crea_capa_raster</span><span class="p">(</span><span class="n">ecuacion</span><span class="p">,</span><span class="n">lista_capas</span><span class="p">,</span><span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_join.tif&quot;</span><span class="p">,</span><span class="n">decimales</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">aplica_mascara</span><span class="p">(</span><span class="n">mascara</span><span class="p">,</span> <span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_join.tif&quot;</span><span class="p">,</span> <span class="n">path_salida</span><span class="p">,</span> <span class="n">get_region</span><span class="p">(</span><span class="n">mascara</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">remove_raster</span><span class="p">(</span> <span class="n">path_salida</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_join.tif&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="criterios_ruta_pesos"><a class="viewcode-back" href="../apcsig.html#apcsig.criterios_ruta_pesos">[documentos]</a><span class="k">def</span> <span class="nf">criterios_ruta_pesos</span><span class="p">(</span><span class="n">dicc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; funcion para extraer a partir de  un diccionario, listas de criterios, rutas y pesos para la clp</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">criterios</span><span class="o">=</span> <span class="p">[]</span>
    <span class="n">rutas</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">pesos</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dicc</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">criterios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">rutas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;ruta&#39;</span><span class="p">])</span>
        <span class="n">pesos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">criterios</span><span class="p">,</span> <span class="n">rutas</span><span class="p">,</span> <span class="n">pesos</span> </div>
<div class="viewcode-block" id="ecuacion_class"><a class="viewcode-back" href="../apcsig.html#apcsig.ecuacion_class">[documentos]</a><span class="k">def</span> <span class="nf">ecuacion_class</span><span class="p">(</span><span class="n">cortes</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Función que escribe la ecuación de reclasificación a partir de un intervalo de cortes</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_cortes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cortes</span><span class="p">)</span>
    <span class="n">ecuacion</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cortes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_cortes</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> 
            <span class="n">ecuacion</span><span class="o">+=</span><span class="s1">&#39;logical_and(A&gt;=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cortes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;,A&lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cortes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)*&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; + &#39;</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span> <span class="n">n_cortes</span><span class="o">-</span><span class="mi">2</span> <span class="p">:</span>
            <span class="n">ecuacion</span><span class="o">+=</span><span class="s1">&#39;logical_and(A&gt;=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cortes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, A&lt;=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cortes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)*&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">ecuacion</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ecuacion</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, LANCIS, Instituto de Ecología, UNAM

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>